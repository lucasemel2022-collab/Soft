<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Prophecy of Starless: Cards of Occultism</title>
    <style>
        :root {
            --bg: #05060f;
            --panel: #0c1024;
            --accent: #6f7dff;
            --gold: #ffd36a;
            --red: #ff5a5a;
            --mythical: #ff00ff;
            --shadow: rgba(0, 0, 0, 0.5);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #05060f 50%, #0d1230 100%);
            color: #eaeaf0;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 50%, rgba(111, 125, 255, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(255, 90, 90, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        header {
            padding: 30px 20px;
            text-align: center;
            position: relative;
            z-index: 1;
            background: linear-gradient(180deg, rgba(13, 18, 48, 0.8) 0%, transparent 100%);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(111, 125, 255, 0.2);
        }
        
        header h1 {
            font-size: clamp(24px, 5vw, 38px);
            background: linear-gradient(135deg, #6f7dff 0%, #b899ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            text-shadow: 0 0 30px rgba(111, 125, 255, 0.5);
        }
        
        header p { 
            opacity: .8; 
            font-size: 14px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        #game {
            width: 100%;
            padding: 20px;
            position: relative;
            z-index: 1;
        }
        
        .menu {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 24px;
        }
        
        .menu button {
            background: linear-gradient(145deg, #1a2055 0%, #0e1440 100%);
            color: #fff;
            border: 2px solid rgba(111, 125, 255, 0.3);
            padding: 14px 24px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .menu button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(111, 125, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .menu button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .menu button:hover {
            transform: translateY(-3px);
            border-color: var(--accent);
            box-shadow: 0 6px 20px rgba(111, 125, 255, 0.4);
        }
        
        .menu button:active {
            transform: translateY(-1px);
        }
        
        .panel {
            max-width: 1200px;
            margin: 0 auto;
            background: linear-gradient(135deg, rgba(14, 19, 53, 0.9) 0%, rgba(8, 11, 31, 0.9) 100%);
            border: 1px solid rgba(111, 125, 255, 0.2);
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            animation: fadeIn 0.6s ease;
        }
        
        .card {
            width: clamp(120px, 22vw, 160px);
            height: clamp(180px, 30vw, 240px);
            border-radius: 16px;
            padding: 14px;
            background: linear-gradient(145deg, #1b2060 0%, #0f133a 100%);
            border: 3px solid #444;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.15), transparent 70%);
            transition: opacity 0.4s ease;
            opacity: 0;
            pointer-events: none;
        }
        
        .card:hover::before { 
            opacity: 1; 
        }
        
        .card:hover {
            transform: translateY(-12px) scale(1.08);
            box-shadow: 0 12px 35px rgba(111, 125, 255, 0.5);
        }
        
        .card.back {
            background: linear-gradient(145deg, #1a1a2e, #0f0f1e);
            border-color: #333;
            cursor: default;
        }
        
        .card.back::after {
            content: '‚ú¶';
            position: absolute;
            font-size: 60px;
            color: rgba(111, 125, 255, 0.3);
        }
        
        .card-name {
            text-align: center;
            font-weight: 700;
            font-size: clamp(11px, 2vw, 14px);
            text-shadow: 0 2px 6px rgba(0, 0, 0, 0.8);
            line-height: 1.3;
            z-index: 1;
        }
        
        .card-power {
            text-align: center;
            font-size: clamp(24px, 4vw, 32px);
            font-weight: 900;
            text-shadow: 0 3px 10px rgba(0, 0, 0, 0.9);
            z-index: 1;
            background: linear-gradient(135deg, #fff 0%, #e0e0ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .Common    { border-color: #aaa; box-shadow: 0 6px 20px rgba(170, 170, 170, 0.3); }
        .Rare      { border-color: #3fa9f5; box-shadow: 0 6px 20px rgba(63, 169, 245, 0.4); }
        .Epic      { border-color: #b04cff; box-shadow: 0 6px 20px rgba(176, 76, 255, 0.4); }
        .Legendary { border-color: #ff9f1c; box-shadow: 0 6px 20px rgba(255, 159, 28, 0.5); }
        .Mythical  { border-color: var(--mythical); box-shadow: 0 6px 20px rgba(255, 0, 255, 0.5); }
        .God       { border-color: var(--gold); box-shadow: 0 6px 20px rgba(255, 211, 106, 0.6); }
        .Demon     { border-color: var(--red); box-shadow: 0 6px 20px rgba(255, 90, 90, 0.5); }
        
        .board {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 16px;
        }
        
        .hand {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
            animation: slideIn 0.5s ease;
            margin-top: 12px;
        }
        
        .counter { 
            font-size: 20px; 
            font-weight: 700; 
            margin-bottom: 16px;
            padding: 12px;
            background: rgba(111, 125, 255, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(111, 125, 255, 0.3);
            text-align: center;
        }
        
        .log {
            margin-top: 20px;
            background: rgba(6, 8, 26, 0.8);
            padding: 16px;
            border-radius: 12px;
            min-height: 100px;
            max-height: 180px;
            overflow-y: auto;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(111, 125, 255, 0.2);
            font-size: 14px;
            line-height: 1.6;
        }
        
        .log::-webkit-scrollbar { width: 8px; }
        .log::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.3); border-radius: 4px; }
        .log::-webkit-scrollbar-thumb { background: rgba(111, 125, 255, 0.5); border-radius: 4px; }
        
        .vn {
            max-width: 800px;
            margin: auto;
            animation: fadeIn 0.6s ease;
        }
        
        .vn h2 {
            font-size: clamp(22px, 4vw, 32px);
            margin-bottom: 20px;
            background: linear-gradient(135deg, #6f7dff 0%, #ff9f1c 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .vn p { 
            font-size: 16px; 
            line-height: 1.8; 
            margin-bottom: 16px;
            opacity: 0.95;
        }
        
        .vn button {
            margin: 8px 8px 8px 0;
            position: relative;
            z-index: 1;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-30px); }
            to   { opacity: 1; transform: translateX(0); }
        }
        
        .collection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 20px;
            justify-content: center;
        }
        
        .gacha-rates {
            margin: 20px 0;
            padding: 16px;
            background: rgba(111, 125, 255, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(111, 125, 255, 0.2);
        }
        
        .gacha-rates p {
            margin: 6px 0;
            font-size: 14px;
        }
        
        .gacha-res {
            margin-top: 20px;
            animation: revealCard 0.8s ease;
            display: flex;
            justify-content: center;
        }
        
        @keyframes revealCard {
            0% { transform: rotateY(180deg) scale(0.8); opacity: 0; }
            100% { transform: rotateY(0) scale(1); opacity: 1; }
        }
        
        .currency-display {
            display: inline-block;
            padding: 8px 16px;
            background: linear-gradient(135deg, rgba(255, 211, 106, 0.2), rgba(255, 159, 28, 0.2));
            border: 2px solid rgba(255, 211, 106, 0.4);
            border-radius: 20px;
            font-weight: 700;
            font-size: 18px;
            color: var(--gold);
            margin: 10px 0;
        }

        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }

        .stat-box {
            background: rgba(111, 125, 255, 0.1);
            border: 1px solid rgba(111, 125, 255, 0.3);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            margin-top: 4px;
            color: var(--gold);
        }
        
        @media (max-width: 768px) {
            .board {
                grid-template-columns: 1fr;
            }
            
            .collection-grid {
                grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>‚ú¶ The Prophecy of Starless ‚ú¶</h1>
        <p>Cards of Occultism</p>
    </header>

    <div id="game">
        <div class="menu">
            <button onclick="home()">üè† Home</button>
            <button onclick="rush()">‚öîÔ∏è Rush</button>
            <button onclick="story()">üìñ Story</button>
            <button onclick="gacha()">üé≤ Gacha</button>
            <button onclick="collection()">üÉè Cole√ß√£o</button>
        </div>
        <div id="content" class="panel"></div>
    </div>

    <script>
        const saveKey = "starless_save_v3";
        let state = JSON.parse(localStorage.getItem(saveKey)) || {
            collection: ["Narumo / Noctis", "Maia / Nisha"],
            currency: 100,
            chapter: 1,
            route: null,
            rushWins: 0,
            totalBattles: 0
        };

        function save() {
            localStorage.setItem(saveKey, JSON.stringify(state));
        }

        const cards = {
            "Narumo / Noctis": { rarity: "Common", power: 2, ot: true },
            "Maia / Nisha": { rarity: "Rare", power: 3, ot: true },
            "Novermoore": { rarity: "Rare", power: 3, ot: true },
            "Rivena": { rarity: "Common", power: 2, ot: true },
            "Eskarf": { rarity: "Common", power: 2, ot: true },
            "Duskbane": { rarity: "Epic", power: 4, ot: true },
            "Asterion": { rarity: "Legendary", power: 5, ot: true },
            "Ihiko": { rarity: "Legendary", power: 5, ot: true },
            "Ashina": { rarity: "Mythical", power: 6, ot: true },
            "Alizza, Demon of Manipulation": { rarity: "Demon", power: 7, ot: false, sup: "alizza" },
            "Isya": { rarity: "God", power: 7, ot: false, sup: "isya" },
            "Rune": { rarity: "God", power: 7, ot: false, sup: "rune" },
            "Nemesis": { rarity: "Demon", power: 7, ot: false, sup: "nemesis" }
        };

        const rarityOrder = ["God", "Demon", "Mythical", "Legendary", "Epic", "Rare", "Common"];
        const gachaRates = {
            Common: 0.50,
            Rare: 0.28,
            Epic: 0.15,
            Legendary: 0.05,
            Mythical: 0.015,
            God: 0.0025,
            Demon: 0.0025
        };

        function getRandomCard() {
            const rand = Math.random();
            let cumulative = 0;
            for (const [rarity, prob] of Object.entries(gachaRates)) {
                cumulative += prob;
                if (rand < cumulative) {
                    const pool = Object.keys(cards).filter(name => cards[name].rarity === rarity);
                    return pool[Math.floor(Math.random() * pool.length)];
                }
            }
            return "Narumo / Noctis";
        }

        function makeCard(name, back = false) {
            if (back) return `<div class='card back'></div>`;
            const c = cards[name];
            return `<div class='card ${c.rarity}' data-name='${name}'>
                <div class='card-name'>${name}</div>
                <div class='card-power'>${c.power}</div>
            </div>`;
        }

        function home() {
            const winRate = state.totalBattles > 0 ? ((state.rushWins / state.totalBattles) * 100).toFixed(1) : 0;
            content.innerHTML = `<div class='vn'>
                <h2>Bem-vindo ao Mundo de Starless</h2>
                <p>Um TCG narrativo onde cada carta conta uma hist√≥ria, cada batalha define destinos, e cada escolha molda o futuro.</p>
                
                <div class="stats-panel">
                    <div class="stat-box">
                        <div class="stat-label">Ess√™ncia</div>
                        <div class="stat-value">${state.currency}</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Vit√≥rias</div>
                        <div class="stat-value">${state.rushWins}</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Taxa Vit√≥ria</div>
                        <div class="stat-value">${winRate}%</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Cole√ß√£o</div>
                        <div class="stat-value">${state.collection.length}</div>
                    </div>
                </div>
                
                <p style="margin-top: 20px; opacity: 0.8;">
                    <b>Rush:</b> Enfrente inimigos aleat√≥rios e ganhe Ess√™ncia<br>
                    <b>Story:</b> Explore a narrativa √©pica de Noctis<br>
                    <b>Gacha:</b> Invoque novas cartas para sua cole√ß√£o<br>
                    <b>Cole√ß√£o:</b> Veja todas as suas cartas conquistadas
                </p>
            </div>`;
        }

        function startBattle(enemyName, enemyPool, onWin, autoNext = false) {
            let pWins = 0, eWins = 0, roundNum = 0;
            let lastLost = null;
            let usedCards = [];
            const hand = draw(state.collection);
            const enemy = draw(enemyPool || Object.keys(cards));

            content.innerHTML = `<h2 style="text-align: center; margin-bottom: 20px;">‚öîÔ∏è ${enemyName}</h2>
                <div class='board'>
                    <div>
                        <div class='counter'>${enemyName}: <span id='eC'>0</span> / 2</div>
                        <div class='hand' id='enemy'></div>
                    </div>
                    <div>
                        <div class='counter'>üõ°Ô∏è Voc√™: <span id='pC'>0</span> / 2</div>
                        <div class='hand' id='player'></div>
                    </div>
                </div>
                <div class='log' id='log'>Escolha uma carta para iniciar a batalha...</div>`;

            const eDiv = document.getElementById("enemy");
            const pDiv = document.getElementById("player");

            enemy.forEach(() => eDiv.innerHTML += makeCard("", true));

            hand.forEach(n => {
                const div = document.createElement("div");
                div.innerHTML = makeCard(n);
                div.onclick = () => {
                    if (pWins === 2 || eWins === 2) return;
                    
                    roundNum++;
                    const eCard = enemy.pop();
                    eDiv.lastChild.outerHTML = makeCard(eCard);

                    let p = cards[n].power;
                    let e = cards[eCard].power;
                    let bonusText = "";

                    if (cards[n].sup === "rune") { p += 2; bonusText = " (+2 Rune)"; }
                    if (cards[n].sup === "isya" && lastLost === n) { p += 2; bonusText = " (+2 Isya)"; }
                    if (cards[n].sup === "nemesis" && lastLost === n) { e -= 2; bonusText = " (-2 Nemesis no inimigo)"; }
                    if (cards[n].sup === "alizza") { e -= 1; bonusText = " (-1 Alizza)"; }

                    log(`<b>Rodada ${roundNum}:</b> ${n} (${p}${bonusText}) vs ${eCard} (${e})`);

                    if (p > e) { 
                        pWins++; 
                        state.currency += 25; 
                        lastLost = null; 
                        log(`<span style="color: #4ade80;">‚úì Vit√≥ria! +25 Ess√™ncia</span>`);
                    } else if (p < e) { 
                        eWins++; 
                        lastLost = n; 
                        log(`<span style="color: #ff5a5a;">‚úó Derrota nesta rodada</span>`);
                    } else {
                        // Sistema de desempate: comparar raridade
                        const pRarity = rarityOrder.indexOf(cards[n].rarity);
                        const eRarity = rarityOrder.indexOf(cards[eCard].rarity);
                        
                        if (pRarity < eRarity) {
                            pWins++;
                            state.currency += 25;
                            log(`<span style="color: #ffd36a;">= Empate! Vit√≥ria por raridade superior! +25 Ess√™ncia</span>`);
                        } else if (pRarity > eRarity) {
                            eWins++;
                            log(`<span style="color: #ff5a5a;">= Empate! Derrota por raridade inferior</span>`);
                        } else {
                            // Se ainda empatar em raridade, jogador vence (vantagem)
                            pWins++;
                            state.currency += 15;
                            log(`<span style="color: #ffd36a;">= Empate total! Vantagem do jogador! +15 Ess√™ncia</span>`);
                        }
                    }

                    document.getElementById('pC').innerText = pWins;
                    document.getElementById('eC').innerText = eWins;
                    div.style.opacity = .4;
                    div.style.cursor = 'not-allowed';
                    div.onclick = null;
                    usedCards.push(n);

                    if (pWins === 2) {
                        state.totalBattles++;
                        state.rushWins++;
                        log(`<br><b style="color: #4ade80; font-size: 16px;">üéâ VIT√ìRIA TOTAL! +60 Ess√™ncia</b>`);
                        state.currency += 60;
                        onWin?.();
                        save();
                        if (autoNext) setTimeout(rush, 2500);
                    }
                    if (eWins === 2) {
                        state.totalBattles++;
                        log(`<br><b style="color: #ff5a5a; font-size: 16px;">üíî Derrota... Tente novamente!</b>`);
                        save();
                        if (autoNext) setTimeout(rush, 2500);
                    }
                };
                pDiv.appendChild(div);
            });
        }

        function draw(pool) {
            return [...pool].sort(() => Math.random() - 0.5).slice(0, 3);
        }

        function log(t) {
            const logDiv = document.getElementById("log");
            logDiv.innerHTML += t + "<br>";
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function rush() {
            const playerAvgPower = state.collection.reduce((sum, name) => sum + cards[name].power, 0) / state.collection.length;
            
            let enemyPool;
            if (playerAvgPower < 3) {
                enemyPool = Object.keys(cards).filter(name => cards[name].power <= 3);
            } else if (playerAvgPower < 4.5) {
                enemyPool = Object.keys(cards).filter(name => cards[name].power <= 5);
            } else {
                enemyPool = Object.keys(cards);
            }
            
            startBattle("Bot do Vazio", enemyPool, () => {}, true);
        }

        function story() {
            if (state.chapter === 1) {
                content.innerHTML = `<div class='vn'>
                    <h2>Cap√≠tulo 1 ‚Äì O Astr√¥nomo Renascido</h2>
                    <p>Narumo morre observando as estrelas, seu √∫ltimo suspiro ecoando entre constela√ß√µes antigas.</p>
                    <p>Ele desperta como <b>Noctis</b>, em um mundo dominado por cultos sombrios e deuses esquecidos.</p>
                    <p>Ao seu lado est√° Maia, agora chamada <b>Nisha</b>, sua √∫nica conex√£o com o passado.</p>
                    <button onclick="startBattle('Cultista de Aorio', ['Rivena','Eskarf','Novermoore'], () => {state.chapter=2; save(); story();})">‚öîÔ∏è Enfrentar Cultista</button>
                </div>`;
            } else if (state.chapter === 2) {
                if (!state.route) {
                    content.innerHTML = `<div class='vn'>
                        <h2>Cap√≠tulo 2 ‚Äì Aliados e Trai√ß√µes</h2>
                        <p>Ashina e Ihiko, parte da lend√°ria trailblazer party, tamb√©m foram reencarnados. Eles carregam um contrato obscuro com <b>Alizza</b>.</p>
                        <p>Alizza revela uma verdade perturbadora: Esta √© a primeira vez que Asmodeus, Rei dos Deuses, invocou mais de um salvador. Nisha era uma falsa savior, uma isca.</p>
                        <p><b>Isya</b> aparece em sonhos: "Voc√™ √© meu guerreiro escolhido, Noctis. Juntos, podemos desafiar os deuses."</p>
                        <p style="margin-top: 20px;"><b>Escolha sua rota:</b></p>
                        <button onclick="state.route=1; save(); story();">‚öîÔ∏è Aliar-se a Isya</button>
                        <button onclick="state.route=2; save(); story();">üó£Ô∏è Negociar com Alizza</button>
                        <button onclick="state.route=3; save(); story();">üîç Investigar os reencarnados</button>
                    </div>`;
                } else if (state.route === 1) {
                    content.innerHTML = `<div class='vn'>
                        <h2>Rota 1: Alian√ßa Divina</h2>
                        <p>Voc√™ aceita o poder de Isya. Sua marca brilha em seu peito.</p>
                        <p>Alizza surge: "Ent√£o escolheu o caminho mais dif√≠cil..."</p>
                        <button onclick="startBattle('Alizza, Demon of Manipulation', ['Duskbane','Nemesis','Rivena'], () => {state.chapter=3; state.route=null; save(); story();})">‚öîÔ∏è Enfrentar Alizza</button>
                    </div>`;
                } else if (state.route === 2) {
                    content.innerHTML = `<div class='vn'>
                        <h2>Rota 2: Palavras e Enganos</h2>
                        <p>Voc√™ tenta negociar, mas percebe tarde demais a teia de mentiras.</p>
                        <p>Os traidores revelam suas verdadeiras inten√ß√µes...</p>
                        <button onclick="startBattle('Traidores de Alizza', ['Ihiko','Ashina','Eskarf'], () => {state.chapter=3; state.route=null; save(); story();})">‚öîÔ∏è Defender-se</button>
                    </div>`;
                } else if (state.route === 3) {
                    content.innerHTML = `<div class='vn'>
                        <h2>Rota 3: A Verdade Oculta</h2>
                        <p>Voc√™ descobre fragmentos do contrato proibido que liga Ashina e Ihiko.</p>
                        <p>Os guardi√µes n√£o deixar√£o voc√™ sair vivo com esse conhecimento.</p>
                        <button onclick="startBattle('Guardi√µes do Contrato', ['Ashina','Ihiko','Novermoore'], () => {state.chapter=3; state.route=null; save(); story();})">‚öîÔ∏è Lutar pela verdade</button>
                    </div>`;
                }
            } else {
                content.innerHTML = `<div class='vn'>
                    <h2>Cap√≠tulo 3 ‚Äì O Caminho Adiante</h2>
                    <p>Suas escolhas moldaram o destino de Noctis. O verdadeiro conflito est√° apenas come√ßando...</p>
                    <p><i>A jornada continua nas pr√≥ximas atualiza√ß√µes.</i></p>
                    <button onclick="home()">üè† Voltar ao in√≠cio</button>
                </div>`;
            }
        }

        function gacha() {
            let ratesHtml = '<div class="gacha-rates"><p><b>Taxas de Raridade:</b></p>';
            for (const [rarity, prob] of Object.entries(gachaRates)) {
                ratesHtml += `<p>${rarity}: ${(prob * 100).toFixed(2)}%</p>`;
            }
            ratesHtml += '</div>';
            content.innerHTML = `<div class='vn'>
                <h2>üé≤ Sistema Gacha</h2>
                <p class='currency-display'>‚ú¶ Ess√™ncia: ${state.currency}</p>
                ${ratesHtml}
                <button onclick="roll()">‚ú® Invocar Carta (50 Ess√™ncia)</button>
                <div id='res' class='gacha-res'></div>
            </div>`;
        }

        function roll() {
            if (state.currency < 50) {
                alert("‚ö†Ô∏è Ess√™ncia insuficiente! Jogue Rush para ganhar mais.");
                return;
            }
            state.currency -= 50;
            const c = getRandomCard();
            state.collection.push(c);
            const rarity = cards[c].rarity;
            document.getElementById('res').innerHTML = `
                <div style="text-align: center;">
                    <p style="font-size: 18px; margin-bottom: 10px; color: var(--gold);">Voc√™ obteve:</p>
                    ${makeCard(c)}
                    <p style="margin-top: 10px; font-size: 16px;"><b>${rarity}</b></p>
                </div>`;
            save();
            document.querySelector('.currency-display').innerHTML = `‚ú¶ Ess√™ncia: ${state.currency}`;
        }

        function collection() {
            if (state.collection.length === 0) {
                content.innerHTML = `<div class='vn'>
                    <h2>üÉè Sua Cole√ß√£o</h2>
                    <p>Ainda n√£o possui nenhuma carta...</p>
                    <p>V√° para o Gacha ou enfrente desafios no Rush para come√ßar sua cole√ß√£o!</p>
                </div>`;
                return;
            }

            const sorted = [...state.collection].sort((a, b) => {
                const ra = rarityOrder.indexOf(cards[a]?.rarity || "Common");
                const rb = rarityOrder.indexOf(cards[b]?.rarity || "Common");
                return ra - rb;
            });

            let cardsHtml = '<div class="collection-grid">';
            sorted.forEach(name => {
                cardsHtml += makeCard(name);
            });
            cardsHtml += '</div>';

            content.innerHTML = `<div class='vn'>
                <h2>üÉè Sua Cole√ß√£o (${state.collection.length} cartas)</h2>
                <p class='currency-display'>‚ú¶ Ess√™ncia: ${state.currency}</p>
                ${cardsHtml}
            </div>`;
        }

        document.addEventListener("DOMContentLoaded", () => {
            home();
        });
    </script>
</body>
</html>